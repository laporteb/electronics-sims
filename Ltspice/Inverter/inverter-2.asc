Version 4
SHEET 1 3280 2468
WIRE 880 352 688 352
WIRE 1072 352 880 352
WIRE 1232 352 1072 352
WIRE 1472 352 1232 352
WIRE 1792 352 1792 288
WIRE 1792 352 1472 352
WIRE 2112 352 1792 352
WIRE 1472 384 1472 352
WIRE 1584 384 1472 384
WIRE 1792 384 1792 352
WIRE 1904 384 1792 384
WIRE 2112 384 2112 352
WIRE 2192 384 2112 384
WIRE 688 400 688 352
WIRE 880 400 880 352
WIRE 1072 400 1072 352
WIRE 1472 400 1472 384
WIRE 1792 400 1792 384
WIRE 2112 400 2112 384
WIRE 1424 416 1392 416
WIRE 1584 416 1584 384
WIRE 1744 416 1712 416
WIRE 1904 416 1904 384
WIRE 2064 416 2032 416
WIRE 2192 416 2192 384
WIRE 256 496 96 496
WIRE 480 496 336 496
WIRE 688 496 688 464
WIRE 688 496 480 496
WIRE 1232 496 1232 352
WIRE 1472 496 1472 480
WIRE 1584 496 1584 480
WIRE 1584 496 1472 496
WIRE 1792 512 1792 480
WIRE 1904 512 1904 480
WIRE 1904 512 1792 512
WIRE 2112 512 2112 480
WIRE 2192 512 2192 480
WIRE 2192 512 2112 512
WIRE 1472 544 1472 496
WIRE 2240 544 1472 544
WIRE 2320 544 2240 544
WIRE 2512 544 2400 544
WIRE 2688 544 2592 544
WIRE 2800 544 2768 544
WIRE 96 624 96 496
WIRE 256 624 96 624
WIRE 480 624 336 624
WIRE 880 624 880 464
WIRE 880 624 480 624
WIRE 1792 640 1792 512
WIRE 2240 640 1792 640
WIRE 2320 640 2240 640
WIRE 2512 640 2400 640
WIRE 2688 640 2592 640
WIRE 2800 640 2800 544
WIRE 2800 640 2768 640
WIRE 2992 640 2800 640
WIRE 96 656 96 624
WIRE 96 656 32 656
WIRE 1232 672 1232 560
WIRE 2992 672 2992 640
WIRE 32 704 32 656
WIRE 1232 752 1232 672
WIRE 2112 752 2112 512
WIRE 2240 752 2112 752
WIRE 2320 752 2240 752
WIRE 2512 752 2400 752
WIRE 2688 752 2592 752
WIRE 2800 752 2800 640
WIRE 2800 752 2768 752
WIRE 96 768 96 656
WIRE 256 768 96 768
WIRE 480 768 336 768
WIRE 1072 768 1072 464
WIRE 1072 768 480 768
WIRE 1472 800 1472 544
WIRE 1584 800 1472 800
WIRE 1792 800 1792 640
WIRE 1904 800 1792 800
WIRE 2112 800 2112 752
WIRE 2224 800 2112 800
WIRE 1472 816 1472 800
WIRE 1792 816 1792 800
WIRE 2112 816 2112 800
WIRE 688 832 688 496
WIRE 880 832 880 624
WIRE 1072 832 1072 768
WIRE 1424 832 1392 832
WIRE 1584 832 1584 800
WIRE 1744 832 1712 832
WIRE 1904 832 1904 800
WIRE 2064 832 2032 832
WIRE 2224 832 2224 800
WIRE 1472 928 1472 896
WIRE 1584 928 1584 896
WIRE 1584 928 1472 928
WIRE 1792 928 1792 896
WIRE 1904 928 1904 896
WIRE 1904 928 1792 928
WIRE 2112 928 2112 896
WIRE 2224 928 2224 896
WIRE 2224 928 2112 928
WIRE 688 960 688 896
WIRE 880 960 880 896
WIRE 880 960 688 960
WIRE 1072 960 1072 896
WIRE 1072 960 880 960
WIRE 1232 960 1232 816
WIRE 1232 960 1072 960
WIRE 1472 960 1472 928
WIRE 1472 960 1232 960
WIRE 1792 960 1792 928
WIRE 1792 960 1472 960
WIRE 2112 960 2112 928
WIRE 2112 960 1792 960
WIRE 1792 1024 1792 960
WIRE 1168 1216 1136 1216
WIRE 1264 1216 1232 1216
WIRE 1504 1264 1424 1264
WIRE 1136 1280 1136 1216
WIRE 1136 1280 1072 1280
WIRE 1168 1280 1136 1280
WIRE 1264 1280 1264 1216
WIRE 1264 1280 1248 1280
WIRE 1296 1280 1264 1280
WIRE 1360 1280 1296 1280
WIRE 1008 1296 736 1296
WIRE 1296 1296 1296 1280
WIRE 1104 1312 1072 1312
WIRE 736 1360 736 1296
WIRE 1168 1408 1136 1408
WIRE 1264 1408 1232 1408
WIRE 176 1424 176 1376
WIRE 1504 1456 1440 1456
WIRE 1104 1472 1104 1312
WIRE 1136 1472 1136 1408
WIRE 1136 1472 1104 1472
WIRE 1168 1472 1136 1472
WIRE 1264 1472 1264 1408
WIRE 1264 1472 1248 1472
WIRE 1296 1472 1264 1472
WIRE 1376 1472 1296 1472
WIRE 1296 1488 1296 1472
WIRE 1200 1632 1168 1632
WIRE 1296 1632 1264 1632
WIRE 176 1664 176 1632
WIRE 1536 1680 1456 1680
WIRE 1168 1696 1168 1632
WIRE 1168 1696 1104 1696
WIRE 1200 1696 1168 1696
WIRE 1296 1696 1296 1632
WIRE 1296 1696 1280 1696
WIRE 1328 1696 1296 1696
WIRE 1392 1696 1328 1696
WIRE 1040 1712 736 1712
WIRE 1328 1712 1328 1696
WIRE 1136 1728 1104 1728
WIRE 736 1760 736 1712
WIRE 1200 1824 1168 1824
WIRE 1296 1824 1264 1824
WIRE 1536 1872 1472 1872
WIRE 1136 1888 1136 1728
WIRE 1168 1888 1168 1824
WIRE 1168 1888 1136 1888
WIRE 1200 1888 1168 1888
WIRE 1296 1888 1296 1824
WIRE 1296 1888 1280 1888
WIRE 1328 1888 1296 1888
WIRE 1408 1888 1328 1888
WIRE 176 1904 176 1872
WIRE 1328 1904 1328 1888
WIRE 1200 2032 1168 2032
WIRE 1296 2032 1264 2032
WIRE 1536 2080 1456 2080
WIRE 1168 2096 1168 2032
WIRE 1168 2096 1104 2096
WIRE 1200 2096 1168 2096
WIRE 1296 2096 1296 2032
WIRE 1296 2096 1280 2096
WIRE 1328 2096 1296 2096
WIRE 1392 2096 1328 2096
WIRE 1040 2112 736 2112
WIRE 1328 2112 1328 2096
WIRE 1136 2128 1104 2128
WIRE 176 2144 176 2112
WIRE 736 2144 736 2112
WIRE 1200 2224 1168 2224
WIRE 1296 2224 1264 2224
WIRE 1536 2272 1472 2272
WIRE 1136 2288 1136 2128
WIRE 1168 2288 1168 2224
WIRE 1168 2288 1136 2288
WIRE 1200 2288 1168 2288
WIRE 1296 2288 1296 2224
WIRE 1296 2288 1280 2288
WIRE 1328 2288 1296 2288
WIRE 1408 2288 1328 2288
WIRE 1328 2304 1328 2288
FLAG 32 704 0
FLAG 480 496 R
FLAG 480 624 S
FLAG 480 768 T
FLAG 1232 352 VBus+
FLAG 1232 672 V0
FLAG 1232 960 Vbus-
FLAG 176 1504 0
FLAG 176 1376 tri
FLAG 176 1744 0
FLAG 176 1984 0
FLAG 176 2224 0
FLAG 176 1632 MotorU
FLAG 176 1872 MotorV
FLAG 176 2112 MotorW
FLAG 736 1440 0
FLAG 736 1840 0
FLAG 736 2224 0
FLAG 1424 464 0
FLAG 1744 464 0
FLAG 2064 464 0
FLAG 2064 880 0
FLAG 1744 880 0
FLAG 1424 880 0
FLAG 1392 416 GateS1
FLAG 1392 832 GateS2
FLAG 1712 416 GateS3
FLAG 1712 832 GateS4
FLAG 2032 416 GateS5
FLAG 2032 832 GateS6
FLAG 2240 544 U
FLAG 2240 640 V
FLAG 2240 752 W
FLAG 1792 208 0
FLAG 1792 1104 0
FLAG 2992 752 0
FLAG 1296 1360 0
FLAG 1296 1552 0
FLAG 1504 1264 GateS1
FLAG 1504 1456 GateS2
FLAG 1328 1776 0
FLAG 1328 1968 0
FLAG 1536 1680 GateS3
FLAG 1536 1872 GateS4
FLAG 1328 2176 0
FLAG 1328 2368 0
FLAG 1536 2080 GateS5
FLAG 1536 2272 GateS6
SYMBOL voltage 352 496 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 377 60 0 0 0)
SYMATTR SpiceLine Rser=1m
SYMBOL voltage 352 624 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value SINE(0 377 60 0 0 120)
SYMATTR SpiceLine Rser=1m
SYMBOL voltage 352 768 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 60 56 VTop 2
SYMATTR InstName V3
SYMATTR Value SINE(0 377 60 0 0 -120)
SYMATTR SpiceLine Rser=1m
SYMBOL voltage 176 1408 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(0 1 0 { 1/ (f_carrier*2) } { 1/ (f_carrier*2) } 0 {1/f_carrier}
SYMBOL voltage 176 1648 R0
WINDOW 0 -32 56 VBottom 2
WINDOW 3 268 70 Top 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value SINE(0.5 {Amod/2} {f_motor} 0 0 0)
SYMBOL voltage 176 1888 R0
WINDOW 0 -32 56 VBottom 2
WINDOW 3 281 62 Top 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value SINE(0.5 {Amod/2} {f_motor} 0 0 120)
SYMBOL voltage 176 2128 R0
WINDOW 0 -32 56 VBottom 2
WINDOW 3 271 74 Top 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value SINE(0.5 {Amod/2} {f_motor} 0 0 -120)
SYMBOL bv 736 1344 R0
SYMATTR InstName B1
SYMATTR Value V=if(V(MotorU)>=V(TRI), 0, 5)
SYMBOL bv 736 1744 R0
SYMATTR InstName B3
SYMATTR Value V=if(V(MotorV)>=V(TRI), 0, 5)
SYMBOL bv 736 2128 R0
SYMATTR InstName B5
SYMATTR Value V=if(V(MotorW)>=V(TRI), 0, 5)
SYMBOL sw 1472 496 M180
SYMATTR InstName S1
SYMBOL sw 1472 912 M180
SYMATTR InstName S2
SYMBOL sw 1792 496 M180
SYMATTR InstName S3
SYMBOL sw 1792 912 M180
SYMATTR InstName S4
SYMBOL sw 2112 496 M180
SYMATTR InstName S5
SYMBOL sw 2112 912 M180
SYMATTR InstName S6
SYMBOL res 2304 560 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value {motor_R}
SYMBOL res 2304 656 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value {motor_R}
SYMBOL res 2304 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value {motor_R}
SYMBOL ind 2496 560 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value {motor_L}
SYMBOL ind 2496 656 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value {motor_L}
SYMBOL ind 2496 768 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L3
SYMATTR Value {motor_L}
SYMBOL voltage 2672 544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -292 163 VBottom 2
WINDOW 123 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value SINE(0 {motor_V} {f_motor} 0 0 0)
SYMATTR SpiceLine Rser=1m
SYMBOL voltage 2672 640 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 Invisible 2
WINDOW 123 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value SINE(0 {motor_V} {f_motor} 0 0 120)
SYMATTR SpiceLine Rser=1m
SYMBOL voltage 2672 752 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 Invisible 2
WINDOW 123 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value SINE(0 {motor_V} {f_motor} 0 0 -120)
SYMATTR SpiceLine Rser=1m
SYMBOL polcap 1216 496 R0
WINDOW 3 24 56 Left 2
SYMATTR Value 470µ
SYMATTR InstName C1
SYMATTR SpiceLine V=450 Irms=2.89 Rser=0.076 Lser=9.11n mfg="Würth Elektronik" pn="861011486024 WCAP-AIG8 35x47" type="Al electrolytic"
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR Value2 x4
SYMBOL res 2976 656 R0
SYMATTR InstName R4
SYMATTR Value 10Meg
SYMBOL res 1776 1008 R0
SYMATTR InstName R5
SYMATTR Value 10Meg
SYMBOL res 1776 192 R0
SYMATTR InstName R6
SYMATTR Value 10Meg
SYMBOL polcap 1216 752 R0
WINDOW 3 24 56 Left 2
SYMATTR Value 470µ
SYMATTR InstName C2
SYMATTR SpiceLine V=450 Irms=2.89 Rser=0.076 Lser=9.11n mfg="Würth Elektronik" pn="861011486024 WCAP-AIG8 35x47" type="Al electrolytic"
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR Value2 x4
SYMBOL diode 704 464 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL diode 896 464 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMBOL diode 1088 464 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMBOL diode 1088 896 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D6
SYMBOL diode 896 896 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMBOL diode 704 896 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMBOL diode 1600 480 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMBOL diode 1920 480 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D10
SYMBOL diode 2208 480 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D11
SYMBOL diode 1600 896 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D8
SYMBOL diode 1920 896 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D9
SYMBOL diode 2240 896 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D12
SYMBOL Digital\\buf 1008 1232 R0
WINDOW 3 -15 -6 Left 2
SYMATTR InstName A1
SYMATTR Value VHIGH=5
SYMBOL res 1264 1264 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL diode 1232 1200 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -18 -3 VTop 2
SYMATTR InstName D13
SYMBOL cap 1280 1296 R0
SYMATTR InstName C3
SYMATTR Value 100p
SYMBOL Digital\\buf 1360 1216 R0
WINDOW 3 -15 -6 Left 2
SYMATTR InstName A2
SYMATTR Value VHIGH=5
SYMBOL Digital\\buf 1376 1408 R0
WINDOW 3 -15 -6 Left 2
SYMATTR InstName A3
SYMATTR Value VHIGH=5
SYMBOL res 1264 1456 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 100
SYMBOL diode 1232 1392 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -18 -3 VTop 2
SYMATTR InstName D14
SYMBOL cap 1280 1488 R0
SYMATTR InstName C4
SYMATTR Value 100p
SYMBOL Digital\\buf 1040 1648 R0
WINDOW 3 -15 -6 Left 2
SYMATTR InstName A4
SYMATTR Value VHIGH=5
SYMBOL res 1296 1680 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100
SYMBOL diode 1264 1616 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -18 -3 VTop 2
SYMATTR InstName D15
SYMBOL cap 1312 1712 R0
SYMATTR InstName C5
SYMATTR Value 100p
SYMBOL Digital\\buf 1392 1632 R0
WINDOW 3 -15 -6 Left 2
SYMATTR InstName A5
SYMATTR Value VHIGH=5
SYMBOL Digital\\buf 1408 1824 R0
WINDOW 3 -15 -6 Left 2
SYMATTR InstName A6
SYMATTR Value VHIGH=5
SYMBOL res 1296 1872 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 100
SYMBOL diode 1264 1808 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -18 -3 VTop 2
SYMATTR InstName D16
SYMBOL cap 1312 1904 R0
SYMATTR InstName C6
SYMATTR Value 100p
SYMBOL Digital\\buf 1040 2048 R0
WINDOW 3 -15 -6 Left 2
SYMATTR InstName A7
SYMATTR Value VHIGH=5
SYMBOL res 1296 2080 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 100
SYMBOL diode 1264 2016 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -18 -3 VTop 2
SYMATTR InstName D17
SYMBOL cap 1312 2112 R0
SYMATTR InstName C7
SYMATTR Value 100p
SYMBOL Digital\\buf 1392 2032 R0
WINDOW 3 -15 -6 Left 2
SYMATTR InstName A8
SYMATTR Value VHIGH=5
SYMBOL Digital\\buf 1408 2224 R0
WINDOW 3 -15 -6 Left 2
SYMATTR InstName A9
SYMATTR Value VHIGH=5
SYMBOL res 1296 2272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100
SYMBOL diode 1264 2208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 -18 -3 VTop 2
SYMATTR InstName D18
SYMBOL cap 1312 2304 R0
SYMATTR InstName C8
SYMATTR Value 100p
TEXT -32 216 Left 2 !.param f_motor=47\n.param f_carrier=10K\n.param Amod=0.9\n.param motor_L=200m\n.param motor_R=500m\n.param motor_V=397
TEXT 256 160 Left 2 !.meas LINE rms (v(R) - v(S) )
TEXT 256 136 Left 2 !.meas DCLINK avg v(VBus+) - v(VBus-)
TEXT 200 1104 Left 4 ;Sine PWM Control Signals
TEXT 1040 264 Left 2 !.model SW SW(Ron=10m Roff=10Meg Vt=2.5 Vh=-2.5)
TEXT 2744 440 Left 2 ;Motor
TEXT 256 48 Left 2 !.meas UVMax max(v(U) -v(V))\n.meas UWMax max(v(U) -v(W))\n.meas VWMax max(v(V) -v(W))
TEXT 704 312 Left 2 !.tran 150m uic
TEXT 1960 232 Left 2 ;R4, R5, R6 required for simulation
TEXT 2920 504 Left 2 !.meas avg(v(n003))
RECTANGLE Normal 2832 816 2272 464 2
RECTANGLE Normal 1664 2416 64 1152 2
